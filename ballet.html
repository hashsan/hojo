<html lang="ja"><head>
  <meta charset="UTF-8">
  
  
  

  <title>バレエ演出家HOJOのサイト</title>

  <link name="debug" rel="canonical" href="https://codepen.io/HOJO-the-decoder/pen/bGyWPQe">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  
  
<style>
@import url('https://hashsan.github.io/hojo/softpink.css');
</style>

  
  
  
</head>

<body>
  <header>
<h1>HOJO site</h1>
</header><main>
  <div class="edit" contenteditable="plaintext-only" style="outline:none;">## これで動くのか
チェック。
これは丸ごと保存される。

### 注意点はラグ
注意点は、ジットハブページを使っているため、そのサイトが更新されるまでのラグがある。しかし、基本的には、ずっとつけっぱなしにしておくことで、問題はなくなる。

</div>
  <nav class="list" style="display:flex;flex-direction:column;margin:3rem 0;"><a>## これで動くのか</a></nav>
</main><footer>
<p>© 2024 HOJO</p>
</footer>
  
      <script id="rendered-js" type="module">
import "https://hashsan.github.io/writer/autoSave.js";

var needsave=false;
const $dde = document.documentElement;
const $edit = document.querySelector('.edit');
const $list = document.querySelector('.list');
$edit.oninput = ()=>needsave=true;
$dde.onkeydown = (event)=>{
  if(event.ctrlKey && event.key==='s'){
    event.preventDefault();
    save();
    return;
  }
  if(event.key==='Enter'){
    list();
  }
}

function getH2(text) {
    // 正規表現を使って、## で始まる見出しを抽出
    const headings = text.match(/^##\s.*/gm);
    // 見出しが見つからない場合は空の配列を返す
    return headings || [];
}
        
async function list(){
  const text = $edit.textContent;
  var ary = getH2(text);
  $list.innerHTML = ary.map(d=>`<a>${d}</a>`).join('\n')
}

async function save(){
  const html = $dde.outerHTML;
  await autoSave(html)
  needsave=false;
}

////
window.addEventListener('beforeunload', function(event) {
  if (needsave) {
    const mes='保存されていない変更があります。ページを離れますか？';
    event.preventDefault();
    event.returnValue = mes;
  }
});
    </script>

  




</body></html>